
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[CVE-2019-16074] Brave Browser AdBlock: Arbitrary Out-of-Bounds Read (AdBlockClient::deserialize) | Vulnerability Disclosure</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="DescriptionBrave Browser implements a built-in AdBlock component that can parse AdBlock Plus filters (e.g. EasyList). The parser is implemented from Brave in native C++ code and was found to be vulner">
<meta property="og:type" content="article">
<meta property="og:title" content="[CVE-2019-16074] Brave Browser AdBlock: Arbitrary Out-of-Bounds Read (AdBlockClient::deserialize)">
<meta property="og:url" content="https://vuln.shellcoder.party/2020/09/14/CVE-2019-16074-Brave-Browser-AdBlock-Arbitrary-Out-of-Bounds-Read-AdBlockClient-deserialize/index.html">
<meta property="og:site_name" content="Vulnerability Disclosure">
<meta property="og:description" content="DescriptionBrave Browser implements a built-in AdBlock component that can parse AdBlock Plus filters (e.g. EasyList). The parser is implemented from Brave in native C++ code and was found to be vulner">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-14T02:47:50.000Z">
<meta property="article:modified_time" content="2020-09-14T10:54:47.469Z">
<meta property="article:author" content="Tanoy Bose">
<meta property="article:tag" content="BraveBrowser">
<meta property="article:tag" content="AdBlock">
<meta property="article:tag" content="Browser">
<meta property="article:tag" content="Fuzzing">
<meta property="article:tag" content="CVE-2019-16074">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
	<!-- If needed, replace your own web font service -->
  <link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,700|Inconsolata|Oswald" rel="stylesheet" />

  
   
  
<link rel="stylesheet" href="/icomoon/style.css">

  
<link rel="stylesheet" href="/style.css">


<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div class="site-wrapper is_post_page">
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<script>document.getElementById("loading-bar").style.width="20%";</script>


<header id="header" class="site-header clearfix">

  <a class="logo square clearfix" href="/">
    <!-- 
      Replace with your own size name, for example:
      <span class="b">A</span>
      <span class="w">B</span>
      <span class="b">C</span>
     <span class="b">V</span>
     <span class="b">U</span>
     <span class="b">L</span>
     <span class="w">N</span>
     <span class="w">E</span>
     <span class="b">R</span>
     <span class="b">A</span>
     <span class="b">B</span>
     <span class="b">I</span>
     <span class="b">L</span>
     <span class="b">I</span>
     <span class="b">T</span>
     <span class="b">Y</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">I</span>
     <span class="b">S</span>
     <span class="w">C</span>
     <span class="w">L</span>
     <span class="b">O</span>
     <span class="b">S</span>
     <span class="b">U</span>
     <span class="b">R</span>
     <span class="b">E</span>
     <span class="b">S</span>
     -->
     <span class="b">0</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">A</span>
     <span class="b">Y</span>
     <span class="b">S</span>
  </a>
  <a class="me square site-nav-switch clearfix">
    <span class="b">
    	<span class="icon icon-menu"></span>
    </span>
  </a>

</header>

    <script>document.getElementById("loading-bar").style.width="40%";</script>
    <main id="main" class="clearfix">
      <article id="post-CVE-2019-16074-Brave-Browser-AdBlock-Arbitrary-Out-of-Bounds-Read-AdBlockClient-deserialize"
  class="article white-box article-type-post"
  itemscope itemprop="blogPost">

  <header class="article-header">
    <h1 class="article-title" itemprop="name">
      [CVE-2019-16074] Brave Browser AdBlock: Arbitrary Out-of-Bounds Read (AdBlockClient::deserialize)
    </h1>
    <div class="article-meta">
      Posted on 
      <time class="article-time" datetime="2020-09-14T02:47:50.000Z" itemprop="datePublished">
        Sep 14, 2020
      </time>
    </div>
  </header>

  <div class="article-entry" itemprop="articleBody">
    <h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>Brave Browser implements a built-in AdBlock component that can parse AdBlock Plus filters (e.g. EasyList). The parser is implemented from Brave in native C++ code and was found to be vulnerable to an out-of-bounds (OOB) read of arbitrary size.<br>Exploiting this vulnerability enables an adversary to read to an arbitrary memory address from Chrome’s privileged process since the AdBlock initialization is executed from the main process before delegating to sandboxed workers. This means one could use this vulnerability to perform information disclosure chain this with other vulnerabilities to perform code execution.</p>
<h1 id="CVSS-3-0-Base-Score"><a href="#CVSS-3-0-Base-Score" class="headerlink" title="CVSS 3.0 Base Score"></a>CVSS 3.0 Base Score</h1><p>6.5 (AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N)</p>
<h1 id="Researcher"><a href="#Researcher" class="headerlink" title="Researcher"></a>Researcher</h1><p>xen1thlabs software labs</p>
<h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><p>The vulnerability was identified via fuzzing of a standalone AdBlock parser implementation and was reproduced in Brave version 1.0.77 and 1.0.94.The crash was initially triaged with Clang’s Address Sanitizer (ASan), which produced the following report.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">&#x3D;&#x3D;22248&#x3D;&#x3D;ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fa1330f673f at pc 0x7fa13705a935</span><br><span class="line"> bp 0x7ffedf96f210 sp 0x7ffedf96e9b8</span><br><span class="line">READ of size 150001 at 0x7fa1330f673f thread T0</span><br><span class="line"> #0 0x7fa13705a934 in __asan_memcpy (&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libasan.so.2+0x8c934)</span><br><span class="line"> #1 0x423783 in BloomFilter::BloomFilter(</span><br><span class="line">char</span><br><span class="line">const*,</span><br><span class="line">int, HashFn*,</span><br><span class="line">int) ..&#x2F;..&#x2F;..&#x2F;node_modules&#x2F;bloom-filter-cpp&#x2F;BloomFilter.cpp:31</span><br><span class="line"> #2 0x40bce9 in AdBlockClient::initBloomFilter(BloomFilter**,</span><br><span class="line">char const*,int) ..&#x2F;..&#x2F;..&#x2F;ad_block_client.cc:1005</span><br><span class="line"> #3 0x413ff7 in AdBlockClient::deserialize(</span><br><span class="line">char*) ..&#x2F;..&#x2F;..&#x2F;ad_block_client.cc:1768</span><br><span class="line"> #4 0x4034df in checkUrls(</span><br><span class="line">char</span><br><span class="line">const*, std::vector&lt;std::__cxx11::basic_string&lt;</span><br><span class="line">char, std::char_traits&lt;</span><br><span class="line">char&gt;, std::allocator&lt;</span><br><span class="line">char&gt; &gt;, std::allocator&lt;std::__cxx11::basic_string&lt;</span><br><span class="line">char, std::char_traits&lt;</span><br><span class="line">char&gt;, std::allocator&lt;</span><br><span class="line">char&gt; &gt; &gt; &gt;</span><br><span class="line">const&amp;) ..&#x2F;..&#x2F;..&#x2F;main.cc:97</span><br><span class="line"> #5 0x40394b in main ..&#x2F;..&#x2F;..&#x2F;main.cc:125</span><br><span class="line"> #6 0x7fa13668c82f in __libc_start_main (&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6+0x2082f)</span><br><span class="line"> #7 0x4026c8 in _start (&#x2F;home&#x2F;dmuser&#x2F;brave&#x2F;sample_asan+0x4026c8)0x7fa1330f673f is located 0 bytes</span><br><span class="line"> to the right of 2694975-</span><br><span class="line">byte region [0x7fa132e64800,0x7fa1330f673f)</span><br><span class="line">allocated by thread T0 here:</span><br><span class="line"> #0 0x7fa137067532 in operator new(unsigned long) (&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libasan.so.2+0x99532)</span><br><span class="line"> #1 0x7fa136d5eeec (&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libstdc++.so.6+0x112eec)</span><br><span class="line"> #2 0x7fa136cfc19d in std::__basic_file&lt;</span><br><span class="line">char&gt;::close() (&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libstdc++.so.6+0xb019d)</span><br><span class="line"> #3 0x7ffedf96f48f (&lt;unknown module&gt;)SUMMARY: AddressSanitizer: heap-buffer-overflow ??:0 __asan_memcpy</span><br><span class="line">Shadow bytes around the buggy address:</span><br><span class="line"> 0x0ff4a6616c90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"> 0x0ff4a6616ca0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"> 0x0ff4a6616cb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"> 0x0ff4a6616cc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line"> 0x0ff4a6616cd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">&#x3D;&gt;0x0ff4a6616ce0: 00 00 00 00 00 00 00[07]fa fa fa fa fa fa fa fa</span><br><span class="line"> 0x0ff4a6616cf0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span><br><span class="line"> 0x0ff4a6616d00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span><br><span class="line"> 0x0ff4a6616d10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span><br><span class="line"> 0x0ff4a6616d20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span><br><span class="line"> 0x0ff4a6616d30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa</span><br><span class="line">Shadow</span><br><span class="line">byte legend (one shadow</span><br><span class="line">byte represents 8 application bytes):</span><br><span class="line"> Addressable: 00</span><br><span class="line"> Partially addressable: 01 02 03 04 05 06 07</span><br><span class="line"> Heap left redzone: fa</span><br><span class="line"> Heap right redzone: fb</span><br><span class="line"> Freed heap region: fd</span><br><span class="line"> Stack left redzone: f1</span><br><span class="line"> Stack mid redzone: f2</span><br><span class="line"> Stack right redzone: f3</span><br><span class="line"> Stack partial redzone: f4</span><br><span class="line"> Stack after</span><br><span class="line">return: f5</span><br><span class="line">Stack use after scope: f8</span><br><span class="line"> Global redzone: f9</span><br><span class="line"> Global init order: f6</span><br><span class="line"> Poisoned by user: f7</span><br><span class="line"> Container overflow: fc</span><br><span class="line"> Array cookie: ac</span><br><span class="line"> Intra object redzone: bb</span><br><span class="line"> ASan internal: fe</span><br><span class="line">&#x3D;&#x3D;22248&#x3D;&#x3D;ABORTING</span><br></pre></td></tr></table></figure>
<p>The top frame indicates an OOB (Out-Of-Bands) read in line 31, with 150001 bytes being read beyond the boundaries of the buffer heap allocated buffer.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">File: bloom-filter-cpp&#x2F;BloomFilter.cpp</span><br><span class="line">21 &#x2F;&#x2F; Constructs a BloomFilter by copying the specified buffer and number of bytes</span><br><span class="line">22 BloomFilter::BloomFilter(const char *buffer, int byteBufferSize, </span><br><span class="line">23 HashFn *hashFns, int numHashFns) :</span><br><span class="line">24 hashFns(nullptr), numHashFns(0), byteBufferSize(0), buffer(nullptr) &#123;</span><br><span class="line">25 this-&gt;hashFns &#x3D; hashFns;</span><br><span class="line">26 this-&gt;numHashFns &#x3D; numHashFns;</span><br><span class="line">27 lastHashes &#x3D; new uint64_t[numHashFns];</span><br><span class="line">28 this-&gt;byteBufferSize &#x3D; byteBufferSize;</span><br><span class="line">29 bitBufferSize &#x3D; byteBufferSize * 8;</span><br><span class="line">30 this-&gt;buffer &#x3D; new char[byteBufferSize];</span><br><span class="line">31 memcpy(this-&gt;buffer, buffer, byteBufferSize);</span><br><span class="line">32 &#125;</span><br></pre></td></tr></table></figure>
<p>BloomFilter::BloomFilter is invoked from AdBlockClient::initBloomFilter (line 1005), as indicated in the second frame of the stack trace.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">File: ad-block&#x2F;ad_block_client.cc </span><br><span class="line">999  void AdBlockClient::initBloomFilter(BloomFilter **pp, </span><br><span class="line">1000      const char *buffer, int len) &#123;</span><br><span class="line">1001    if (*pp) &#123; </span><br><span class="line">1002      delete *pp; </span><br><span class="line">1003    &#125; </span><br><span class="line">1004    if (len &gt; 0) &#123; </span><br><span class="line">1005      *pp &#x3D; new BloomFilter(buffer, len); </span><br><span class="line">1006    &#125; </span><br><span class="line">1007  &#125;</span><br></pre></td></tr></table></figure>
<p>AdBlockClient::initBloomFilter is invoked from AdBlockClient::deserialize (line 1768), as indicated in the third frame of the stack trace. Notice in line 1721 that the bloomFilterSize variable is directly read from the untrusted input file and used to offset the input buffer without any boundary checks taking place. Therefore, an attacker can read up to max size_t bytes beyond the heap buffer, since the integer variable will be eventually casted to size_t in the memcpy call of the BloomFilter::BloomFilter function.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">File: ad-block&#x2F;ad_block_client.cc</span><br><span class="line">1702 bool AdBlockClient::deserialize(</span><br><span class="line">char *buffer) &#123;</span><br><span class="line">1703 deserializedBuffer &#x3D; buffer;</span><br><span class="line">1704</span><br><span class="line">int bloomFilterSize &#x3D; 0, exceptionBloomFilterSize &#x3D; 0,</span><br><span class="line">[..]</span><br><span class="line">1711 sscanf(buffer + pos,</span><br><span class="line">1712</span><br><span class="line">&quot;%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x,%x&quot;,</span><br><span class="line">1713 &amp;numFilters,</span><br><span class="line">1714 &amp;numExceptionFilters, &amp;numCosmeticFilters, &amp;numHtmlFilters,</span><br><span class="line">1715 &amp;numNoFingerprintFilters, &amp;numNoFingerprintExceptionFilters,</span><br><span class="line">1716 &amp;numNoFingerprintDomainOnlyFilters,</span><br><span class="line">1717 &amp;numNoFingerprintAntiDomainOnlyFilters,</span><br><span class="line">1718 &amp;numNoFingerprintDomainOnlyExceptionFilters,</span><br><span class="line">1719 &amp;numNoFingerprintAntiDomainOnlyExceptionFilters,</span><br><span class="line">1720 &amp;numHostAnchoredFilters, &amp;numHostAnchoredExceptionFilters,</span><br><span class="line">1721 &amp;bloomFilterSize, &amp;exceptionBloomFilterSize,</span><br><span class="line">1722 &amp;hostAnchoredHashSetSize, &amp;hostAnchoredExceptionHashSetSize,</span><br><span class="line">1723 &amp;noFingerprintDomainHashSetSize,</span><br><span class="line">1724 &amp;noFingerprintAntiDomainHashSetSize,</span><br><span class="line">1725 &amp;noFingerprintDomainExceptionHashSetSize,</span><br><span class="line">1726 &amp;noFingerprintAntiDomainExceptionHashSetSize);</span><br><span class="line">[..]</span><br><span class="line">1768 initBloomFilter(&amp;bloomFilter, buffer + pos, bloomFilterSize);</span><br></pre></td></tr></table></figure>
<p>Now tracing the place within the application that the AdBlock payload (as downloaded over the Internet from Brave endpoints in AmazonS3) is actually parsed identified the following. The AdBlockClient::deserialize is called in line 197 of the BlockersWorker::InitAdBlock function, which first reads the file contents in line 192 that were downloaded on previous steps (see ADBlockUpdater.UpdateADBlock() invoked early on application launch).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">File: chrome&#x2F;browser&#x2F;net&#x2F;blockers&#x2F;blockers_worker.cc</span><br><span class="line">184 bool BlockersWorker::InitAdBlock() &#123;</span><br><span class="line">185 base::AssertBlockingAllowed();</span><br><span class="line">186 std::lock_guard&lt;std::mutex&gt; guard(adblock_init_mutex_);</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">if (adblock_parser_) &#123;</span><br><span class="line">189</span><br><span class="line">return</span><br><span class="line">true;</span><br><span class="line">190 &#125;</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">if (!GetData(std::to_string(DATA_FILE_VERSION), ADBLOCK_DATA_FILE, adblock_buffer_)) &#123;</span><br><span class="line">193</span><br><span class="line">return</span><br><span class="line">false;</span><br><span class="line">194 &#125;</span><br><span class="line">195</span><br><span class="line">196 adblock_parser_ &#x3D;</span><br><span class="line">new AdBlockClient();</span><br><span class="line">197</span><br><span class="line">if (!adblock_parser_-&gt;deserialize((</span><br><span class="line">char*)&amp;adblock_buffer_.front()))</span><br></pre></td></tr></table></figure>
<p>BlockersWorker::InitAdBlock is invoked from ChromeNetworkDelegate::OnBeforeURLRequest_AdBlockFileWork (line 577). The ChromeNetworkDelegate family of callbacks is the central point from within the chrome code to add hooks into the network stack that executed from the main process.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">File: chrome&#x2F;browser&#x2F;net&#x2F;chrome_network_delegate.cc</span><br><span class="line">575 void ChromeNetworkDelegate::OnBeforeURLRequest_AdBlockFileWork(std::shared_ptr&lt;OnBeforeURLRequestContext&gt;</span><br><span class="line"> ctx) &#123;</span><br><span class="line">576 base::AssertBlockingAllowed();</span><br><span class="line">577 blockers_worker_-&gt;InitAdBlock();</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">if (ctx-&gt;isAdBlockRegionalEnabled &amp;&amp;</span><br><span class="line">580 !blockers_worker_-&gt;isAdBlockerRegionalInitialized()) &#123;</span><br><span class="line">581 blockers_worker_-&gt;InitAdBlockRegional();</span><br><span class="line">582 &#125;</span><br><span class="line">583 &#125;</span><br></pre></td></tr></table></figure>
<p>As a proof of concept the malformed file generated from the fuzzer was provided as input to the Brave application (served over the web via a Man-in-The-Middle attack by replacing   4ABPFilterParserData.dat file). Upon visiting any URL the main process of the Brave Browser crashed with the following logcat message.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">04-03 08:28:42.933 3641 3659 I cr_ADB : Downloaded 4ABPFilterParserData.dat</span><br><span class="line">04-03 08:28:42.933 3641 3659 I cr_ADB : Creating ABPFilterParserDataDownloaded.dat from</span><br><span class="line"> 4ABPFilterParserData.dat</span><br><span class="line">04-03 08:28:42.937 3641 3659 I cr_ADB : Created ABPFilterParserDataDownloaded.dat from</span><br><span class="line"> 4ABPFilterParserData.dat</span><br><span class="line">04-03 08:28:42.950 3641 3659 I cr_ADB : Downloading 6.0httpse.leveldb.zip</span><br><span class="line">04-03 08:28:58.671 3641 3659 I cr_ADB : Downloaded 6.0httpse.leveldb.zip</span><br><span class="line">04-03 08:28:58.894 3641 3659 I cr_ADB : Creating httpse.leveldbDownloaded.zip from</span><br><span class="line"> 6.0httpse.leveldb</span><br><span class="line">04-03 08:28:58.895 3641 3659 I cr_ADB : Created httpse.leveldbDownloaded.zip from 6.0httpse.leveldb</span><br><span class="line">04-03 08:29:10.352 3641 3641 W cr_AutocompleteEdit: Using spannable model...</span><br><span class="line">04-03 08:29:10.355 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:10.370 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:10.405 3641 3646 I zygote : Do partial code cache collection, code&#x3D;62KB, data&#x3D;49KB</span><br><span class="line">04-03 08:29:10.405 3641 3646 I zygote : After code cache collection, code&#x3D;62KB, data&#x3D;49KB</span><br><span class="line">04-03 08:29:10.405 3641 3646 I zygote : Increasing code cache capacity to 256KB</span><br><span class="line">04-03 08:29:10.604 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:10.617 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:10.619 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.154 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.159 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:12.171 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.194 3641 3641 W cr_UrlBar: Text change observed, triggering autocomplete.</span><br><span class="line">04-03 08:29:12.194 3641 3641 W cr_Autocomplete: onTextChangedForAutocomplete</span><br><span class="line">04-03 08:29:12.194 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:12.225 3641 3641 W cr_Autocomplete: starting autocomplete controller..[</span><br><span class="line">false][</span><br><span class="line">false]</span><br><span class="line">04-03 08:29:12.229 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.234 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.351 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.354 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:12.372 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.374 3641 3641 W cr_UrlBar: Text change observed, triggering autocomplete.</span><br><span class="line">04-03 08:29:12.374 3641 3641 W cr_Autocomplete: onTextChangedForAutocomplete</span><br><span class="line">04-03 08:29:12.374 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:12.406 3641 3641 W cr_Autocomplete: starting autocomplete controller..[</span><br><span class="line">false][false]</span><br><span class="line">04-03 08:29:12.410 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.412 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.531 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.532 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:12.539 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.542 3641 3641 W cr_UrlBar: Text change observed, triggering autocomplete.</span><br><span class="line">04-03 08:29:12.542 3641 3641 W cr_Autocomplete: onTextChangedForAutocomplete</span><br><span class="line">04-03 08:29:12.542 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:12.573 3641 3641 W cr_Autocomplete: starting autocomplete controller..[</span><br><span class="line">false][</span><br><span class="line">false]</span><br><span class="line">04-03 08:29:12.577 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.578 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.735 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.737 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:12.740 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.743 3641 3641 W cr_UrlBar: Text change observed, triggering autocomplete.</span><br><span class="line">04-03 08:29:12.743 3641 3641 W cr_Autocomplete: onTextChangedForAutocomplete</span><br><span class="line">04-03 08:29:12.743 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:12.774 3641 3641 W cr_Autocomplete: starting autocomplete controller..[</span><br><span class="line">false][04-03 08:29:12.778 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.780 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.906 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.910 3641 3641 I chatty : uid&#x3D;10081(com.brave.browser) identical 2 lines</span><br><span class="line">04-03 08:29:12.925 3641 3641 W cr_SpanAutocomplete: Did not notify - in batch edit.</span><br><span class="line">04-03 08:29:12.928 3641 3641 W cr_UrlBar: Text change observed, triggering autocomplete.</span><br><span class="line">04-03 08:29:12.928 3641 3641 W cr_Autocomplete: onTextChangedForAutocomplete</span><br><span class="line">04-03 08:29:12.928 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:12.960 3641 3641 W cr_Autocomplete: starting autocomplete controller..[</span><br><span class="line">false][</span><br><span class="line">false]04-03 08:29:12.963 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:12.965 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:13.410 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:13.561 3641 3641 W cr_SpanAutocomplete: Did not notify - ignored.</span><br><span class="line">04-03 08:29:13.568 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:13.569 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:13.570 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:13.571 3641 3641 W cr_Autocomplete: stopping autocomplete.</span><br><span class="line">04-03 08:29:13.571 3641 3641 W cr_SpanAutocomplete: Did not notify - no change.</span><br><span class="line">04-03 08:29:13.578 3641 3689 E cr_ApiBridge: Failed to init handler: Attempt to invoke virtual</span><br><span class="line"> method&#39;java.lang.reflect.Constructor java.lang.</span><br><span class="line">Class.getDeclaredConstructor(java.lang.</span><br><span class="line">Class[])&#39; on a</span><br><span class="line">null object reference</span><br><span class="line">04-03 08:29:13.589 3641 3641 W IInputConnectionWrapper: getSelectedText on inactive InputConnection</span><br><span class="line">04-03 08:29:13.592 3641 3641 W IInputConnectionWrapper: requestCursorAnchorInfo on inactive</span><br><span class="line"> InputConnection</span><br><span class="line">04-03 08:29:13.592 3641 3641 W IInputConnectionWrapper: getTextBeforeCursor on inactive</span><br><span class="line"> InputConnection</span><br><span class="line">04-03 08:29:13.595 3641 3641 W IInputConnectionWrapper: getTextBeforeCursor on inactive</span><br><span class="line"> InputConnection</span><br><span class="line">04-03 08:29:13.598 3641 3641 W IInputConnectionWrapper: getTextBeforeCursor on inactive</span><br><span class="line"> InputConnection</span><br><span class="line">04-03 08:29:15.852 3641 3641 W cr_SpanAutocomplete: Did not notify - ignored.</span><br><span class="line">04-03 08:29:15.893 3641 3641 I zygote : Deoptimizing void bmi.onMeasure(</span><br><span class="line">int,</span><br><span class="line">int) due to JIT inline cache</span><br><span class="line">04-03 08:29:15.908 3641 3689 F libc : Fatal signal 8 (SIGFPE), code -6, fault addr 0xe39 in tid</span><br><span class="line"> 3689 (Chrome_IOThread), pid 3641 (m.brave.browser)</span><br><span class="line">04-03 08:29:15.964 3834 3834 I crash_dump32: obtaining output fd from tombstoned, type:</span><br><span class="line"> kDebuggerdTombstone</span><br><span class="line">04-03 08:29:15.968 3834 3834 I crash_dump32: performing dump of process 3641 (target tid &#x3D; 3689)</span><br><span class="line">04-03 08:29:15.968 3834 3834 F DEBUG : *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***</span><br><span class="line"> ***</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : Build fingerprint:</span><br><span class="line">&#39;Android&#x2F;aosp_sailfish&#x2F;sailfish:8.1.0&#x2F;OPM4.171019.021.P1&#x2F;anesti09272147:userdebug&#x2F;test-keys&#39;</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : Revision:</span><br><span class="line">&#39;0&#39;</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : ABI:</span><br><span class="line">&#39;arm&#39;</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : pid: 3641, tid: 3689, name: Chrome_IOThread &gt;&gt;&gt;</span><br><span class="line"> com.brave.browser &lt;&lt;&lt;</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : signal 8 (SIGFPE), code -6 (SI_TKILL), fault addr --------</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : r0 00000000 r1 00000e69 r2 00000008 r3 c4a7f344</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : r4 c4a7f344 r5 00000000 r6 dc4535e8 r7 0000010c</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : r8 0000000e r9 dc46b7ee sl dc46bdd0 fp 0000000e</span><br><span class="line">04-03 08:29:15.969 3834 3834 F DEBUG : ip c4a7f344 sp c4a7f328 lr c64dec00 pc e70eebbc</span><br><span class="line"> cpsr 00070010</span><br><span class="line">04-03 08:29:15.970 3834 3834 F DEBUG :</span><br><span class="line">04-03 08:29:15.970 3834 3834 F DEBUG : backtrace:</span><br><span class="line">04-03 08:29:15.970 3834 3834 F DEBUG : #00 pc 0004abbc &#x2F;system&#x2F;lib&#x2F;libc.so (tgkill+12)</span><br><span class="line">04-03 08:29:15.970 3834 3834 F DEBUG : #01 pc 00035bfc &#x2F;data&#x2F;app&#x2F;</span><br><span class="line">com.brave.browser-3sVE2mDMPdmzlOkZCO13Hw&#x3D;&#x3D;&#x2F;base.apk (offset 0x16dc000)</span><br><span class="line">04-03 08:29:17.198 626 626 I Zygote :</span><br><span class="line">Process 3641 exited due to signal (8)</span><br></pre></td></tr></table></figure>
<h1 id="POC-Attachments"><a href="#POC-Attachments" class="headerlink" title="POC Attachments"></a>POC Attachments</h1><p>Not released</p>
<h1 id="Disclosure-Timelines"><a href="#Disclosure-Timelines" class="headerlink" title="Disclosure Timelines"></a>Disclosure Timelines</h1><ul>
<li>19-Jun-2019 - Notified vendor</li>
<li>15-Aug-2019 - Brave browser Android v1.2.0 released which resolves this</li>
</ul>

  </div>
  
  <div class="article-tags">
    
      <a class="tag-link" href="/tags/AdBlock/" rel="tag">AdBlock</a><a class="tag-link" href="/tags/BraveBrowser/" rel="tag">BraveBrowser</a><a class="tag-link" href="/tags/Browser/" rel="tag">Browser</a><a class="tag-link" href="/tags/CVE-2019-16074/" rel="tag">CVE-2019-16074</a><a class="tag-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a>
    
  </div>

  

</article>

      <script>document.getElementById("loading-bar").style.width="60%";</script>
    </main>
    
<footer id="footer" class="clearfix">
	
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" 
				class="u-search-input st-default-search-input"
				data-list-highlight="true" 
				data-list-value-completion="true" 
				placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	
  <div>&copy; <a href="https://vuln.shellcoder.party">Vulnerability Disclosure</a> by <a href="https://shellcoder.party" target="_blank" rel="noopener">Tanoy Bose</a>; Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div>
  <div>Powered by <a href="https://hexo.io/" target="_blank" rel="external noopener">Hexo</a>.</div>
</footer>


    <script>document.getElementById("loading-bar").style.width="80%";</script>
    <div class="overlay"></div>
  </div>
  <div class="site-sidebar">

	
	
	<div class="sidebar-switch clearfix "
		style="display: none">
		<a class="dark-btn active" data-toggle="toc">
	    <span class="icon icon-list"></span>
	    <span class="text">Index</span>
	  </a>
	  <a class="dark-btn" data-toggle="bio">
	    <span class="icon icon-person"></span>
	    <span class="text">Bio</span>
	  </a>
	</div>

	<div class="site-toc "
		style="display: none">
		
	    <div class="no-index">No Index</div>
	  
  </div>
  
	<div class="site-bio show"
		style="display: block">
		
	  <!-- About Me -->
	  <div class="about-me clearfix">
	    <div class="avatar">
	      <img src="/img/avatar.jpg" />
	    </div>
	    <div class="info">
	      <!-- <a class="name dark-btn" href="/about"> -->
	      <a class="name dark-btn" href="http://shellcoder.party" target="_blank" rel="noopener">
	        Tanoy Bose
	      </a>
	    </div>
	    <div class="info">
	      <span class="item desc">
	        Namaste.<br>You can know about me at my <a href="https://shellcoder.party" style="color:#ffffff" target="_blank">portfolio</a>.<br>I follow my own <a href="/2017/02/15/vulnerability-disclosure-policy/" style="color:#ffffff"> Vulnerability Disclosure Policy</a>.<br>Most of my work is listed <a href="https://repo.shellcoder.party" style="color:#ffffff" target="_blank">here</a>.
	      </span>
	    </div>
	  </div>
	
	  <!-- Social Icons -->
	  <div class="social clearfix">
	    
	      
	        <a href="/atom.xml" class="feed"
	          target="_blank" rel="external">
	          <span class="icon icon-feed"></span>
	        </a>
	      
	        <a href="/cve@shellcoder.party" class="email"
	          target="_blank" rel="external">
	          <span class="icon icon-email"></span>
	        </a>
	      
	        <a href="https://github.com/n0tty" class="github"
	          target="_blank" rel="external">
	          <span class="icon icon-github"></span>
	        </a>
	      
	        <a href="https://twitter.com/TanoyBose" class="twitter"
	          target="_blank" rel="external">
	          <span class="icon icon-twitter"></span>
	        </a>
	      
	        <a href="https://linkedin.com/in/tanoybose" class="linkedin"
	          target="_blank" rel="external">
	          <span class="icon icon-linkedin"></span>
	        </a>
	      
	    
	  </div>

	</div>

	<div class="shortcuts">
		<a href="#header" class="top window-nav dark-btn" id="go-top">
			<span class="icon icon-chevron-thin-up"></span>
		</a>
		<a class="close dark-btn" id="sidebar-close">
			<span class="icon icon-close"></span>
		</a>
		<a href="#footer" class="top window-nav dark-btn" id="go-bottom">
			<span class="icon icon-chevron-thin-down"></span>
		</a>
	</div>

</div>

  <!-- Universal Search -->

<script type="text/javascript">
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "AIzaSyCBDLDVabwj4C6zhzbhxdKVNUrDG5xKR-8";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "aefb6b3d52745e73f";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "google";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.js"><\/script>')</script>


<script src="/js/search.js"></script>


<script src="/js/app.js"></script>


<!-- Disqus -->



<!-- Valine -->


<!-- Swiftype -->
<!-- Please replace with your own swiftype settings -->
<!--
<script type="text/javascript">
  /* Swiftype */
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','FHMeAyBdVccJECstf-XJ','2.0.0');
</script>
-->

  <script>document.getElementById("loading-bar").style.width="100%";</script>
</body>
</html>
