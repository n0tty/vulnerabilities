
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[Security Improvement] SymantecPGP Viewer for Android: Weak overlay security | Vulnerability Disclosure</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="DescriptionSymantec PGP Viewer does not implement FLAG_SECURE flag in its application. This allows any malicious application to be able to capture screenshots and record the screen. When a user opens">
<meta property="og:type" content="article">
<meta property="og:title" content="[Security Improvement] SymantecPGP Viewer for Android: Weak overlay security">
<meta property="og:url" content="https://vuln.shellcoder.party/2020/09/14/Unassigned-SymantecPGP-Viewer-for-Android-Weak-overlay-security/index.html">
<meta property="og:site_name" content="Vulnerability Disclosure">
<meta property="og:description" content="DescriptionSymantec PGP Viewer does not implement FLAG_SECURE flag in its application. This allows any malicious application to be able to capture screenshots and record the screen. When a user opens">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-14T02:14:26.000Z">
<meta property="article:modified_time" content="2021-09-19T21:05:13.693Z">
<meta property="article:author" content="Tanoy Bose">
<meta property="article:tag" content="Android">
<meta property="article:tag" content="SymantecPGPViewer">
<meta property="article:tag" content="Security Improvement">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
	<!-- If needed, replace your own web font service -->
  <link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,700|Inconsolata|Oswald" rel="stylesheet" />

  
   
  
<link rel="stylesheet" href="/icomoon/style.css">

  
<link rel="stylesheet" href="/style.css">


<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div class="site-wrapper is_post_page">
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<script>document.getElementById("loading-bar").style.width="20%";</script>


<header id="header" class="site-header clearfix">

  <a class="logo square clearfix" href="/">
    <!-- 
      Replace with your own size name, for example:
      <span class="b">A</span>
      <span class="w">B</span>
      <span class="b">C</span>
     <span class="b">V</span>
     <span class="b">U</span>
     <span class="b">L</span>
     <span class="w">N</span>
     <span class="w">E</span>
     <span class="b">R</span>
     <span class="b">A</span>
     <span class="b">B</span>
     <span class="b">I</span>
     <span class="b">L</span>
     <span class="b">I</span>
     <span class="b">T</span>
     <span class="b">Y</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">I</span>
     <span class="b">S</span>
     <span class="w">C</span>
     <span class="w">L</span>
     <span class="b">O</span>
     <span class="b">S</span>
     <span class="b">U</span>
     <span class="b">R</span>
     <span class="b">E</span>
     <span class="b">S</span>
     -->
     <span class="b">0</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">A</span>
     <span class="b">Y</span>
     <span class="b">S</span>
  </a>
  <a class="me square site-nav-switch clearfix">
    <span class="b">
    	<span class="icon icon-menu"></span>
    </span>
  </a>

</header>

    <script>document.getElementById("loading-bar").style.width="40%";</script>
    <main id="main" class="clearfix">
      <article id="post-Unassigned-SymantecPGP-Viewer-for-Android-Weak-overlay-security"
  class="article white-box article-type-post"
  itemscope itemprop="blogPost">

  <header class="article-header">
    <h1 class="article-title" itemprop="name">
      [Security Improvement] SymantecPGP Viewer for Android: Weak overlay security
    </h1>
    <div class="article-meta">
      Posted on 
      <time class="article-time" datetime="2020-09-14T02:14:26.000Z" itemprop="datePublished">
        Sep 14, 2020
      </time>
    </div>
  </header>

  <div class="article-entry" itemprop="articleBody">
    <h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>Symantec PGP Viewer does not implement <code>FLAG_SECURE</code> flag in its application. This allows any malicious application to be able to capture screenshots and record the screen. When a user opens an encrypted email via Symantec PGP Viewer, a malicious user could potentially capture the screen and get the decrypted contents of  the email.</p>
<h1 id="CVSS"><a href="#CVSS" class="headerlink" title="CVSS"></a>CVSS</h1><p>NA</p>
<h1 id="Researcher"><a href="#Researcher" class="headerlink" title="Researcher"></a>Researcher</h1><p>Tanoy Bose (xen1thlabs)</p>
<h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><p>Certain applications from the google play store utilize the “draw-on-top” access to capture the UI. Such access permission is available with applications like skype. This application can now also access the MediaProjection API to record the screen, resulting in the application to record the entire screen.<br>To protect from this, the application needs to implement <code>FLAG_SECURE</code> flag in the application.<br>For our POC, we testing this using a screen recorder application called AZ Free Recorder.</p>
<h1 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability?"></a>Vulnerability?</h1><p>I do not classify this as a critical security vulnerability. However, this is definitely a good security improvement that can be utilized to prevent attacks like Cloak and Dagger. If the intended use of this application is for secure/ confidential communication, I would not consider this to be a secure practice.</p>
<h1 id="Disclosure-Timeline"><a href="#Disclosure-Timeline" class="headerlink" title="Disclosure Timeline"></a>Disclosure Timeline</h1><p>In our past experience with Symantec, they stated end point based security vulnerabilities/ improvements are not a concern for SymantecPGPViewer. They intend only to fix security issues that compromise PGP integrity over the network. And hence won’t fix such issues.</p>

  </div>
  
  <div class="article-tags">
    
      <a class="tag-link" href="/tags/Android/" rel="tag">Android</a><a class="tag-link" href="/tags/Security-Improvement/" rel="tag">Security Improvement</a><a class="tag-link" href="/tags/SymantecPGPViewer/" rel="tag">SymantecPGPViewer</a>
    
  </div>

  

</article>

      <script>document.getElementById("loading-bar").style.width="60%";</script>
    </main>
    
<footer id="footer" class="clearfix">
	
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" 
				class="u-search-input st-default-search-input"
				data-list-highlight="true" 
				data-list-value-completion="true" 
				placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	
  <div>&copy; <a href="https://vuln.shellcoder.party">Vulnerability Disclosure</a> by <a href="https://shellcoder.party" target="_blank" rel="noopener">Tanoy Bose</a>; Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div>
  <div>Powered by <a href="https://hexo.io/" target="_blank" rel="external noopener">Hexo</a>.</div>
</footer>


    <script>document.getElementById("loading-bar").style.width="80%";</script>
    <div class="overlay"></div>
  </div>
  <div class="site-sidebar">

	
	
	<div class="sidebar-switch clearfix "
		style="display: none">
		<a class="dark-btn active" data-toggle="toc">
	    <span class="icon icon-list"></span>
	    <span class="text">Index</span>
	  </a>
	  <a class="dark-btn" data-toggle="bio">
	    <span class="icon icon-person"></span>
	    <span class="text">Bio</span>
	  </a>
	</div>

	<div class="site-toc "
		style="display: none">
		
	    <div class="no-index">No Index</div>
	  
  </div>
  
	<div class="site-bio show"
		style="display: block">
		
	  <!-- About Me -->
	  <div class="about-me clearfix">
	    <div class="avatar">
	      <img src="/img/avatar.jpg" />
	    </div>
	    <div class="info">
	      <!-- <a class="name dark-btn" href="/about"> -->
	      <a class="name dark-btn" href="http://shellcoder.party" target="_blank" rel="noopener">
	        Tanoy Bose
	      </a>
	    </div>
	    <div class="info">
	      <span class="item desc">
	        Namaste.<br>You can know about me at my <a href="https://shellcoder.party" style="color:#ffffff" target="_blank">portfolio</a>.<br>I follow my own <a href="/2020/09/19/vulnerability-disclosure-policy/" style="color:#ffffff"> Vulnerability Disclosure Policy</a>.<br>Most of my work is listed <a href="https://repo.shellcoder.party" style="color:#ffffff" target="_blank">here</a>.
	      </span>
	    </div>
	  </div>
	
	  <!-- Social Icons -->
	  <div class="social clearfix">
	    
	      
	        <a href="/atom.xml" class="feed"
	          target="_blank" rel="external">
	          <span class="icon icon-feed"></span>
	        </a>
	      
	        <a href="/cve@shellcoder.party" class="email"
	          target="_blank" rel="external">
	          <span class="icon icon-email"></span>
	        </a>
	      
	        <a href="https://github.com/n0tty" class="github"
	          target="_blank" rel="external">
	          <span class="icon icon-github"></span>
	        </a>
	      
	        <a href="https://twitter.com/TanoyBose" class="twitter"
	          target="_blank" rel="external">
	          <span class="icon icon-twitter"></span>
	        </a>
	      
	        <a href="https://linkedin.com/in/tanoybose" class="linkedin"
	          target="_blank" rel="external">
	          <span class="icon icon-linkedin"></span>
	        </a>
	      
	    
	  </div>

	</div>

	<div class="shortcuts">
		<a href="#header" class="top window-nav dark-btn" id="go-top">
			<span class="icon icon-chevron-thin-up"></span>
		</a>
		<a class="close dark-btn" id="sidebar-close">
			<span class="icon icon-close"></span>
		</a>
		<a href="#footer" class="top window-nav dark-btn" id="go-bottom">
			<span class="icon icon-chevron-thin-down"></span>
		</a>
	</div>

</div>

  <!-- Universal Search -->

<script type="text/javascript">
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "AIzaSyCBDLDVabwj4C6zhzbhxdKVNUrDG5xKR-8";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "aefb6b3d52745e73f";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "google";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.js"><\/script>')</script>


<script src="/js/search.js"></script>


<script src="/js/app.js"></script>


<!-- Disqus -->



<!-- Valine -->


<!-- Swiftype -->
<!-- Please replace with your own swiftype settings -->
<!--
<script type="text/javascript">
  /* Swiftype */
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','FHMeAyBdVccJECstf-XJ','2.0.0');
</script>
-->

  <script>document.getElementById("loading-bar").style.width="100%";</script>
</body>
</html>
